<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gallery | Hyeri</title>
    <link rel="icon" href="icon/icon.png" type="image/png">
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@300;400&family=Playfair+Display:ital,wght@0,400;0,600;1,400&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="cursor-dot"></div>
    <div class="cursor-outline"></div>

    <header class="fixed-header">
        <div class="header-inner">
            <a href="index.html" class="logo">HYERI.</a>
            <a href="index.html" style="text-transform:uppercase; font-size:0.8rem; letter-spacing:2px;">Back Home</a>
        </div>
    </header>

    <main>
        <section class="gallery-hero">
            <div class="container">
                <h1>Visual Archives</h1>
                <p>Curated Moments</p>
            </div>
        </section>

        <section class="container">
            <!-- Slider Area -->
            <div class="slider-wrapper" id="sliderWrapper" style="display:none;">
                <div class="slider-track" id="sliderTrack"></div>
                <div class="slider-controls">
                    <button class="slider-btn" id="prevBtn">←</button>
                    <button class="slider-btn" id="nextBtn">→</button>
                </div>
            </div>

            <!-- Masonry Grid -->
            <div id="loading" style="text-align:center; margin: 50px 0; color:#666;">Loading Archive...</div>
            <div class="masonry-grid" id="masonryGrid"></div>
        </section>
    </main>

    <!-- Logic -->
    <script src="https://unpkg.com/@studio-freight/lenis@1.0.29/dist/lenis.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="js/app.js"></script>

    <script>
        // --- API & SLIDER LOGIC ---
        const API_URL = 'https://api.hyeri.us.kg';
        const SLIDER_FOLDER = '/hyerigallery/';
        const MASONRY_FOLDER = '/leehyeri/';
        
        // Slider Logic
        let slideIndex = 0;
        const track = document.getElementById('sliderTrack');
        
        async function initPage() {
            try {
                const res = await fetch(API_URL);
                const data = await res.json();
                if(!data.success) return;

                // 1. Setup Slider
                const sliderImages = data.images.filter(url => url.includes(SLIDER_FOLDER));
                if(sliderImages.length > 0) {
                    document.getElementById('sliderWrapper').style.display = 'block';
                    sliderImages.forEach(url => {
                        const div = document.createElement('div');
                        div.className = 'slider-slide';
                        div.innerHTML = `<img src="${url}" alt="Slide">`;
                        track.appendChild(div);
                    });
                    
                    // Slider Controls
                    document.getElementById('nextBtn').addEventListener('click', () => {
                        slideIndex = (slideIndex + 1) % sliderImages.length;
                        updateSlider();
                    });
                    document.getElementById('prevBtn').addEventListener('click', () => {
                        slideIndex = (slideIndex - 1 + sliderImages.length) % sliderImages.length;
                        updateSlider();
                    });
                }

                // 2. Setup Masonry
                const masonryImages = data.images.filter(url => url.includes(MASONRY_FOLDER));
                const grid = document.getElementById('masonryGrid');
                document.getElementById('loading').style.display = 'none';
                
                // Load all (or batch) for masonry
                masonryImages.forEach(url => {
                    const div = document.createElement('div');
                    div.className = 'masonry-item';
                    const img = document.createElement('img');
                    img.src = url;
                    img.loading = 'lazy';
                    img.onload = () => img.classList.add('loaded');
                    div.appendChild(img);
                    grid.appendChild(div);
                });

            } catch(e) { console.error(e); }
        }

        function updateSlider() {
            track.style.transform = `translateX(-${slideIndex * 100}%)`;
        }

        initPage();
    </script>
</body>
</html>